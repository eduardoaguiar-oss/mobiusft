// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// Mobius Forensic Toolkit
// Copyright (C)
// 2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025
// Eduardo Aguiar
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the
// Free Software Foundation; either version 2, or (at your option) any later
// version.
//
// This program is distributed in the hope that it will be useful, but
// WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General
// Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program. If not, see <http://www.gnu.org/licenses/>.
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#include "file_main_db.hpp"
#include <mobius/core/database/database.hpp>
#include <mobius/core/datetime/datetime.hpp>
#include <mobius/core/io/tempfile.hpp>
#include <mobius/core/log.hpp>
#include <mobius/core/string_functions.hpp>
#include <format>
#include <limits>
#include <unordered_map>
#include <unordered_set>
#include "common.hpp"

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// References:
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// main.db file tables
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//
// - Accounts
//      - about: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - ad_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - added_in_shared_group: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - alertstring: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - aliases: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - assigned_comment: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - assigned_speeddial: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authorized_time: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authreq_history: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authreq_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authrequest_count: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authrequest_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - availability: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_image: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - birthday: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - buddyblob: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - buddycount_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - capabilities: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cbl_future: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cblsyncstatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - chat_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - city: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cobrand_id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - commitstatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - country: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - displayname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - emails: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - federated_presence_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - flamingo_xmpp_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - fullname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - gender: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - given_authlevel: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - given_displayname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - homepage: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - in_shared_group: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - ipcountry: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - languages: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - lastonline_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - lastused_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - liveid_membername: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - logoutreason: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - mood_text: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - mood_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - node_capabilities: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - node_capabilities_and: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nr_of_other_instances: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nrof_authed_buddies: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - offline_authreq_id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - offline_callforward: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - option_ui_color: 97, 100, 141, 168, 308
//      - options_change_future: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - owner_under_legal_age: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_channel_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_optedout: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_home: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_mobile: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_office: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phonenumbers_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - profile_attachments: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - profile_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - province: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_call_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstnnumber: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pwdchangestatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - received_authrequest: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - refreshing: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - registration_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - revoked_auth: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - rich_mood_text: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - roaming_history_enabled: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest_serial: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest_time: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - service_provider_info: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - set_availability: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - shortcircuit_sync: 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skype_call_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypein_numbers: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypename: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_balance: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_balance_currency: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_precision: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - stack_version: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - subscriptions: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - suggested_skypename: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - synced_email: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - timezone: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - timezone_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - type: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - uses_jcs: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - verified_company: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - verified_email: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - voicemail_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - webpresence_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//
// - CallMembers
//      - admit_failure_reason: 97, 100, 141, 162, 168, 259, 308
//      - balance_update: 97, 100, 141, 168, 308
//      - call_db_id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - call_duration: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - call_end_diagnostics_code: 97, 100, 141, 168, 308
//      - call_name: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - call_session_guid: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - country: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - creation_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - debuginfo: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - dispname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - failurereason: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - fallback_in_progress: 72, 77, 81, 84-85, 97, 100, 133, 141, 149, 162, 164, 168, 209, 235, 259, 308
//      - forward_targets: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - forwarded_by: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - guid: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - identity: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - identity_type: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - ip_address: 67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_conference: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_multiparty_video_capable: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_premium_video_sponsor: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_read_only: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_seamlessly_upgraded_call: 67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_server_muted: 97, 100, 141, 162, 168, 209, 235, 259, 308
//      - is_video_codec_compatible: 67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - languages: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - light_weight_meeting_role: 97, 100, 141, 162, 168, 209, 235, 259, 308
//      - limiting_factor: 97, 100, 141, 168, 308
//      - mike_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - next_redial_time: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nonse_word: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nr_of_delivered_push_notifications: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nrof_redials_done: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nrof_redials_left: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - payment_category: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pk_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - price_currency: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - price_per_minute: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - price_precision: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - prime_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_feedback: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_statustext: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - quality_problems: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - quality_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - real_identity: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - recovery_in_progress: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - role: 97, 100, 141, 168, 308
//      - seconds_left: 97, 100, 141, 168, 308
//      - sounderror_code: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - soundlevel: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - start_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - stats_xml: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - target_identity: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - tenant_id: 97, 100, 141, 168, 308
//      - transfer_active: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - transfer_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - transfer_topic: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - transferred_by: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - transferred_to: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - type: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - version_string: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - videostatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - voicechannel: 72, 77, 81, 84-85, 97, 100, 107, 133, 141, 149, 162, 164, 168, 209, 235, 259, 308
//
// - Calls
//      - access_token: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - active_members: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - begin_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - broadcast_metadata: 97, 100, 141, 168, 308
//      - conf_participants: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - content_sharing_session_count_changed: 97, 100, 141, 168, 308
//      - conv_dbid: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - current_video_audience: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - duration: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - failurecode: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - failurereason: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - host_identity: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_active: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_conference: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_incoming: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_incoming_one_on_one_video_call: 97, 100, 141, 168, 308
//      - is_muted: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_muted_speaker: 97, 100, 141, 168, 308
//      - is_on_hold: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_premium_video_sponsor: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_server_muted: 97, 100, 141, 162, 168, 209, 235, 259, 308
//      - is_unseen_missed: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - joined_existing: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - light_weight_meeting_count_changed: 97, 100, 141, 162, 168, 209, 235, 259, 308
//      - meeting_details: 97, 100, 141, 168, 308
//      - members: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - mike_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - name: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - old_duration: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - old_members: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_dispname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_handle: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - premium_video_is_grace_period: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - premium_video_sponsor_list: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - premium_video_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_number: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - quality_problems: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - queue_info: 97, 100, 168, 308
//      - role: 97, 100, 141, 168, 308
//      - server_identity: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - soundlevel: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - start_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - technology: 72, 77, 81, 84-85, 97, 100, 133, 141, 149, 162, 164, 168, 209, 235, 259, 308
//      - tenant_id: 97, 100, 141, 168, 308
//      - topic: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - transferor_displayname: 97, 100, 168, 308
//      - transferor_type: 97, 100, 168, 308
//      - type: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - vaa_input_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - video_disabled: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//
// - Contacts
//      - about: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - account_modification_serial_nr: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - added_in_shared_group: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - alertstring: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - aliases: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_comment: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone1: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone1_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone2: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone2_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone3: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone3_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_speeddial: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authorization_certificate: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authorized_time: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_crc: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_history: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_initmethod: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_nodeinfo: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_src: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authrequest_count: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - availability: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_image: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_url: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - birthday: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - buddyblob: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - buddystatus: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - capabilities: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - cbl_future: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - certificate_send_count: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - city: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - contactlist_track: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - country: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - displayname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - emails: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - external_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - external_system_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_external_data: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_must_hide_avatar: 66
//      - extprop_seen_birthday: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_sms_pstn_contact_created: 97, 100, 141, 168, 308
//      - extprop_sms_target: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - firstname: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - fullname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - gender: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - given_authlevel: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - given_displayname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - group_membership: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - hashed_emails: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - homepage: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - in_shared_group: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - ipcountry: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - is_auto_buddy: 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152, 162, 164, 196, 209, 235, 259
//      - is_mobile: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_trusted: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - isauthorized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - isblocked: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - languages: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - last_used_networktime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - lastname: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - lastonline_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - lastused_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - liveid_cid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - main_phone: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - mood_text: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - mood_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - network_availability: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - node_capabilities: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - node_capabilities_and: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nr_of_buddies: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nrof_authed_buddies: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - offline_authreq_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_home: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_home_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_mobile: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_mobile_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_office: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_office_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pop_score: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - popularity_ord: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - profile_attachments: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - profile_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - province: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pstnnumber: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - received_authrequest: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - refreshing: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - revoked_auth: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - rich_mood_text: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - saved_directory_blob: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_extrasbitmask: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_initmethod: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_serial: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_time: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - server_synced: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - skypename: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - stack_version: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - timezone: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - unified_servants: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - verified_company: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - verified_email: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//
// - SMSes
//      - body: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_id: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - convo_name: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - error_category: 67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - event_flags: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failurereason: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 0, 66-67, 69, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - identity: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - is_failed_unseen: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - is_permanent: 0, 66-67, 69, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - notification_id: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - outgoing_reply_type: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - price: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - price_currency: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - price_precision: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - reply_id_number: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - reply_to_number: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - status: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - target_numbers: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - target_statuses: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - timestamp: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 0, 66-67, 69, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//
// - Transfers
//      - accepttime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - bytespersecond: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - bytestransferred: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_guid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_index: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - convo_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failurereason: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filename: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filepath: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filesize: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - finishtime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - flags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - last_activity: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nodeid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - offer_send_list: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - old_filepath: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - old_status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - parent_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_dispname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_handle: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pk_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - starttime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//
// - Voicemails
//      - allowed_duration: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_guid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - convo_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - duration: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_hide_from_history: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failurereason: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failures: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - flags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - notification_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_dispname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_handle: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - path: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - playback_progress: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - size: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - subject: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - vflags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - xmsg: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

namespace
{
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// Constants
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief DEBUG flag
static constexpr bool DEBUG = false;

// @brief Last known schema version
static constexpr std::int64_t LAST_KNOWN_SCHEMA_VERSION = 308;

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Unknown schema versions
// This set contains schema versions that are not recognized or not handled
// by the current implementation. It is used to identify unsupported versions
// of the main.db schema in Skype applications.
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
static std::unordered_set<std::int64_t> UNKNOWN_SCHEMA_VERSIONS = {
    1,   2,   3,   4,   5,   6,   7,   8,   9,   10,  11,  12,  13,  14,  15,
    16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,
    31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,  42,  43,  44,  45,
    46,  47,  48,  49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59,  60,
    61,  62,  63,  64,  65,  68,  70,  71,  73,  74,  75,  76,  78,  79,
    80,  82,  83,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  98,
    99,  101, 102, 103, 104, 105, 106, 108, 109, 110, 111, 112, 113, 115, 116,
    117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
    132, 134, 135, 136, 137, 138, 139, 140, 142, 143, 144, 145, 146, 147, 148,
    150, 151, 154, 155, 156, 157, 158, 159, 160, 161, 163, 165, 166, 167, 169,
    170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184,
    185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 197, 198, 199, 200,
    201, 202, 203, 204, 205, 206, 207, 208, 210, 211, 212, 213, 214, 215, 216,
    217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231,
    232, 233, 234, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247,
    248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 260, 261, 262, 263,
    264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278,
    279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293,
    294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307,
};

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Get database schema version
// @param db Database object
// @return Schema version or 0 if not found
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
static std::int64_t
get_db_schema_version (mobius::core::database::database &db)
{
    std::int64_t schema_version = 0;

    mobius::core::log log (__FILE__, __FUNCTION__);

    try
    {
        if (!db.has_table ("AppSchemaVersion"))
        {
            log.info (
                __LINE__,
                "AppSchemaVersion table not found. Path: " + db.get_path ()
            );
            return 0;
        }

        auto stmt = db.new_statement (
            "SELECT SQLiteSchemaVersion FROM AppSchemaVersion"
        );

        if (stmt.fetch_row ())
        {
            schema_version = stmt.get_column_int64 (0);

            if (!schema_version)
            {
                log.warning (
                    __LINE__, "Schema version = 0. Path: " + db.get_path ()
                );
            }
        }
        else
        {
            log.warning (
                __LINE__,
                "Schema version not found in AppSchemaVersion table. Path: " +
                    db.get_path ()
            );
        }
    }
    catch (const std::exception &e)
    {
        log.warning (
            __LINE__, std::string (e.what ()) + ". Path: " + db.get_path ()
        );
    }

    return schema_version;
}

} // namespace

namespace mobius::extension::app::skype
{
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Constructor
// @param reader Reader object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
file_main_db::file_main_db (const mobius::core::io::reader &reader)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    if (!reader)
        return;

    try
    {
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Copy reader content to temporary file
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        mobius::core::io::tempfile tfile;
        tfile.copy_from (reader);

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Get schema version
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        mobius::core::database::database db (tfile.get_path ());
        schema_version_ = get_db_schema_version (db);

        if (schema_version_ > LAST_KNOWN_SCHEMA_VERSION ||
            UNKNOWN_SCHEMA_VERSIONS.find (schema_version_) !=
                UNKNOWN_SCHEMA_VERSIONS.end ())
        {
            log.development (
                __LINE__,
                "Unhandled schema version: " + std::to_string (schema_version_)
            );
        }

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Load data
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        _load_accounts (db);
        _load_calls (db);
        _load_contacts (db);
        _load_file_transfers (db);
        _load_sms (db);
        _load_voicemails (db);

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Finish decoding
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        is_instance_ = true;
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load accounts
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_accounts (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    try
    {
        auto stmt = db.new_statement (
            "SELECT about, "
            "ad_policy, "
            "added_in_shared_group, "
            "alertstring, "
            "aliases, "
            "assigned_comment, "
            "assigned_speeddial, "
            "authorized_time, "
            "authreq_history, "
            "authreq_timestamp, "
            "authrequest_count, "
            "authrequest_policy, "
            "availability, "
            "avatar_image, "
            "avatar_policy, "
            "avatar_timestamp, "
            "birthday, "
            "buddyblob, "
            "buddycount_policy, "
            "capabilities, "
            "cbl_future, "
            "cblsyncstatus, "
            "chat_policy, "
            "city, "
            "${cobrand_id:1-*}, "
            "commitstatus, "
            "country, "
            "displayname, "
            "emails, "
            "${federated_presence_policy:1-*}, "
            "${flamingo_xmpp_status:1-*}, "
            "fullname, "
            "gender, "
            "given_authlevel, "
            "given_displayname, "
            "homepage, "
            "id, "
            "in_shared_group, "
            "ipcountry, "
            "is_permanent, "
            "languages, "
            "lastonline_timestamp, "
            "lastused_timestamp, "
            "${liveid_membername:1-*}, "
            "logoutreason, "
            "mood_text, "
            "mood_timestamp, "
            "node_capabilities, "
            "node_capabilities_and, "
            "nr_of_other_instances, "
            "nrof_authed_buddies, "
            "offline_authreq_id, "
            "offline_callforward, "
            "${options_change_future:1-*}, "
            "owner_under_legal_age, "
            "${partner_channel_status:1-*}, "
            "partner_optedout, "
            "phone_home, "
            "phone_mobile, "
            "phone_office, "
            "phonenumbers_policy, "
            "profile_attachments, "
            "profile_timestamp, "
            "province, "
            "pstn_call_policy, "
            "pstnnumber, "
            "pwdchangestatus, "
            "received_authrequest, "
            "refreshing, "
            "registration_timestamp, "
            "revoked_auth, "
            "rich_mood_text, "
            "${roaming_history_enabled:1-*}, "
            "sent_authrequest, "
            "sent_authrequest_serial, "
            "sent_authrequest_time, "
            "service_provider_info, "
            "set_availability, "
            "${shortcircuit_sync:72-*}, "
            "skype_call_policy, "
            "skypein_numbers, "
            "skypename, "
            "skypeout_balance, "
            "skypeout_balance_currency, "
            "skypeout_precision, "
            "stack_version, "
            "status, "
            "subscriptions, "
            "suggested_skypename, "
            "synced_email, "
            "timezone, "
            "timezone_policy, "
            "type, "
            "${uses_jcs:1-*}, "
            "${verified_company:1-*}, "
            "${verified_email:1-*}, "
            "voicemail_policy, "
            "webpresence_policy "
            "FROM accounts",
            schema_version_
        );

        // Retrieve rows from query
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            account a;

            // Set attributes
            a.idx = idx++;
            a.schema_version = schema_version_;
            a.about = stmt.get_column_string (0);
            a.ad_policy = stmt.get_column_int64 (1);
            a.added_in_shared_group = stmt.get_column_int64 (2);
            a.alertstring = stmt.get_column_string (3);
            a.aliases = stmt.get_column_string (4);
            a.assigned_comment = stmt.get_column_string (5);
            a.assigned_speeddial = stmt.get_column_string (6);
            a.authorized_time = stmt.get_column_int64 (7);
            a.authreq_history = stmt.get_column_bytearray (8);
            a.authreq_timestamp = get_datetime (stmt.get_column_int64 (9));
            a.authrequest_count = stmt.get_column_int64 (10);
            a.authrequest_policy = stmt.get_column_int64 (11);
            a.availability = stmt.get_column_int64 (12);
            a.avatar_image = stmt.get_column_bytearray (13);
            a.avatar_policy = stmt.get_column_int64 (14);
            a.avatar_timestamp = get_datetime (stmt.get_column_int64 (15));
            a.birthday = get_birthday (stmt.get_column_int64 (16));
            a.buddyblob = stmt.get_column_bytearray (17);
            a.buddycount_policy = stmt.get_column_int64 (18);
            a.capabilities = stmt.get_column_bytearray (19);
            a.cbl_future = stmt.get_column_bytearray (20);
            a.cblsyncstatus = stmt.get_column_int64 (21);
            a.chat_policy = stmt.get_column_int64 (22);
            a.city = stmt.get_column_string (23);
            a.cobrand_id = stmt.get_column_int64 (24);
            a.commitstatus = stmt.get_column_int64 (25);
            a.country = stmt.get_column_string (26);
            a.displayname = stmt.get_column_string (27);
            a.emails = stmt.get_column_string (28);
            a.federated_presence_policy = stmt.get_column_int64 (29);
            a.flamingo_xmpp_status = stmt.get_column_int64 (30);
            a.fullname = stmt.get_column_string (31);
            a.gender = stmt.get_column_int64 (32);
            a.given_authlevel = stmt.get_column_int64 (33);
            a.given_displayname = stmt.get_column_string (34);
            a.homepage = stmt.get_column_string (35);
            a.id = stmt.get_column_int64 (36);
            a.in_shared_group = stmt.get_column_int64 (37);
            a.ipcountry = stmt.get_column_string (38);
            a.is_permanent = stmt.get_column_bool (39);
            a.languages = stmt.get_column_string (40);
            a.lastonline_timestamp = get_datetime (stmt.get_column_int64 (41));
            a.lastused_timestamp = get_datetime (stmt.get_column_int64 (42));
            a.liveid_membername = stmt.get_column_string (43);
            a.logoutreason = stmt.get_column_int64 (44);
            a.mood_text = stmt.get_column_string (45);
            a.mood_timestamp = get_datetime (stmt.get_column_int64 (46));
            a.node_capabilities = stmt.get_column_int64 (47);
            a.node_capabilities_and = stmt.get_column_int64 (48);
            a.nr_of_other_instances = stmt.get_column_int64 (49);
            a.nrof_authed_buddies = stmt.get_column_int64 (50);
            a.offline_authreq_id = stmt.get_column_int64 (51);
            a.offline_callforward = stmt.get_column_string (52);
            a.options_change_future = stmt.get_column_bytearray (53);
            a.owner_under_legal_age = stmt.get_column_int64 (54);
            a.partner_channel_status = stmt.get_column_string (55);
            a.partner_optedout = stmt.get_column_string (56);
            a.phone_home = stmt.get_column_string (57);
            a.phone_mobile = stmt.get_column_string (58);
            a.phone_office = stmt.get_column_string (59);
            a.phonenumbers_policy = stmt.get_column_int64 (60);
            a.profile_attachments = stmt.get_column_bytearray (61);
            a.profile_timestamp = get_datetime (stmt.get_column_int64 (62));
            a.province = stmt.get_column_string (63);
            a.pstn_call_policy = stmt.get_column_int64 (64);
            a.pstnnumber = stmt.get_column_string (65);
            a.pwdchangestatus = stmt.get_column_int64 (66);
            a.received_authrequest = stmt.get_column_string (67);
            a.refreshing = stmt.get_column_int64 (68);
            a.registration_timestamp =
                get_datetime (stmt.get_column_int64 (69) * 60);
            a.revoked_auth = stmt.get_column_int64 (70);
            a.rich_mood_text = stmt.get_column_string (71);
            a.roaming_history_enabled = stmt.get_column_bool (72);
            a.sent_authrequest = stmt.get_column_string (73);
            a.sent_authrequest_serial = stmt.get_column_int64 (74);
            a.sent_authrequest_time = stmt.get_column_int64 (75);
            a.service_provider_info = stmt.get_column_string (76);
            a.set_availability = stmt.get_column_int64 (77);
            a.shortcircuit_sync = stmt.get_column_int64 (78);
            a.skype_call_policy = stmt.get_column_int64 (79);
            a.skypein_numbers = stmt.get_column_string (80);
            a.skypename = stmt.get_column_string (81);
            a.skypeout_balance = stmt.get_column_int64 (82);
            a.skypeout_balance_currency = stmt.get_column_string (83);
            a.skypeout_precision = stmt.get_column_int64 (84);
            a.stack_version = stmt.get_column_int64 (85);
            a.status = stmt.get_column_int64 (86);
            a.subscriptions = stmt.get_column_string (87);
            a.suggested_skypename = stmt.get_column_string (88);
            a.synced_email = stmt.get_column_bytearray (89);
            a.timezone = get_timezone (stmt.get_column_int64 (90));
            a.timezone_policy = stmt.get_column_int64 (91);
            a.type = stmt.get_column_int64 (92);
            a.uses_jcs = stmt.get_column_int64 (93);
            a.verified_company = stmt.get_column_bytearray (94);
            a.verified_email = stmt.get_column_bytearray (95);
            a.voicemail_policy = stmt.get_column_int64 (96);
            a.webpresence_policy = stmt.get_column_int64 (97);

            // Add to accounts vector
            accounts_.emplace_back (std::move (a));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load Calls
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_calls (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    try
    {
        std::unordered_multimap<std::int64_t, call_member> call_members;

        // Prepare SQL statement for table CallMembers
        auto stmt_cm = db.new_statement (
            "SELECT ${admit_failure_reason:97-*},"
            "${balance_update:97-*},"
            "${call_db_id:66-*},"
            "${call_duration:66-*},"
            "${call_end_diagnostics_code:97-*},"
            "${call_name:66-*},"
            "${call_session_guid:66-*},"
            "${country:66-*},"
            "${creation_timestamp:66-*},"
            "${debuginfo:66-*},"
            "${dispname:66-*},"
            "${failurereason:66-*},"
            "${fallback_in_progress:72-*},"
            "${forward_targets:66-*},"
            "${forwarded_by:66-*},"
            "${guid:66-*},"
            "${id:66-*},"
            "${identity:66-*},"
            "${identity_type:66-*},"
            "${ip_address:67-*},"
            "${is_conference:66-*},"
            "${is_multiparty_video_capable:66-*},"
            "${is_permanent:66-*},"
            "${is_premium_video_sponsor:66-*},"
            "${is_read_only:66-*},"
            "${is_seamlessly_upgraded_call:67-*},"
            "${is_server_muted:97-*},"
            "${is_video_codec_compatible:67-*},"
            "${languages:66-*},"
            "${light_weight_meeting_role:97-*},"
            "${limiting_factor:97-*},"
            "${mike_status:66-*},"
            "${next_redial_time:66-*},"
            "${nonse_word:66-*},"
            "${nr_of_delivered_push_notifications:66-*},"
            "${nrof_redials_done:66-*},"
            "${nrof_redials_left:66-*},"
            "${payment_category:66-*},"
            "${pk_status:66-*},"
            "${price_currency:66-*},"
            "${price_per_minute:66-*},"
            "${price_precision:66-*},"
            "${prime_status:66-*},"
            "${pstn_feedback:66-*},"
            "${pstn_statustext:66-*},"
            "${quality_problems:66-*},"
            "${quality_status:66-*},"
            "${real_identity:66-*},"
            "${recovery_in_progress:66-*},"
            "${role:97-*},"
            "${seconds_left:97-*},"
            "${sounderror_code:66-*},"
            "${soundlevel:66-*},"
            "${start_timestamp:66-*},"
            "${stats_xml:66-*},"
            "${status:66-*},"
            "${target_identity:66-*},"
            "${tenant_id:97-*},"
            "${transfer_active:66-*},"
            "${transfer_status:66-*},"
            "${transfer_topic:66-*},"
            "${transferred_by:66-*},"
            "${transferred_to:66-*},"
            "${type:66-*},"
            "${version_string:66-*},"
            "${videostatus:66-*},"
            "${voicechannel:72-*} "
            "FROM CallMembers",
            schema_version_
        );

        // Retrieve records from CallMembers table
        std::uint64_t idx = 0;

        while (stmt_cm.fetch_row ())
        {
            call_member obj;

            obj.idx = idx++;
            obj.admit_failure_reason = stmt_cm.get_column_int64 (0);
            obj.balance_update = stmt_cm.get_column_string (1);
            obj.call_db_id = stmt_cm.get_column_int64 (2);
            obj.call_duration = stmt_cm.get_column_int64 (3);
            obj.call_end_diagnostics_code = stmt_cm.get_column_string (4);
            obj.call_name = stmt_cm.get_column_string (5);
            obj.call_session_guid = stmt_cm.get_column_string (6);
            obj.country = stmt_cm.get_column_string (7);
            obj.creation_timestamp = get_datetime (stmt_cm.get_column_int64 (8));
            obj.debuginfo = stmt_cm.get_column_string (9);
            obj.dispname = stmt_cm.get_column_string (10);
            obj.failurereason = stmt_cm.get_column_int64 (11);
            obj.fallback_in_progress = stmt_cm.get_column_int64 (12);
            obj.forward_targets = stmt_cm.get_column_string (13);
            obj.forwarded_by = stmt_cm.get_column_string (14);
            obj.guid = stmt_cm.get_column_string (15);
            obj.id = stmt_cm.get_column_int64 (16);
            obj.identity = stmt_cm.get_column_string (17);
            obj.identity_type = stmt_cm.get_column_int64 (18);
            obj.ip_address = stmt_cm.get_column_string (19);
            obj.is_conference = stmt_cm.get_column_bool (20);
            obj.is_multiparty_video_capable = stmt_cm.get_column_bool (21);
            obj.is_permanent = stmt_cm.get_column_bool (22);
            obj.is_premium_video_sponsor = stmt_cm.get_column_bool (23);
            obj.is_read_only = stmt_cm.get_column_bool (24);
            obj.is_seamlessly_upgraded_call = stmt_cm.get_column_bool (25);
            obj.is_server_muted = stmt_cm.get_column_bool (26);
            obj.is_video_codec_compatible = stmt_cm.get_column_bool (27);
            obj.languages = stmt_cm.get_column_string (28);
            obj.light_weight_meeting_role = stmt_cm.get_column_int64 (29);
            obj.limiting_factor = stmt_cm.get_column_int64 (30);
            obj.mike_status = stmt_cm.get_column_int64 (31);
            obj.next_redial_time = stmt_cm.get_column_int64 (32);
            obj.nonse_word = stmt_cm.get_column_string (33);
            obj.nr_of_delivered_push_notifications =
                stmt_cm.get_column_int64 (34);
            obj.nrof_redials_done = stmt_cm.get_column_int64 (35);
            obj.nrof_redials_left = stmt_cm.get_column_int64 (36);
            obj.payment_category = stmt_cm.get_column_string (37);
            obj.pk_status = stmt_cm.get_column_int64 (38);
            obj.price_currency = stmt_cm.get_column_string (39);
            obj.price_per_minute = stmt_cm.get_column_int64 (40);
            obj.price_precision = stmt_cm.get_column_int64 (41);
            obj.prime_status = stmt_cm.get_column_int64 (42);
            obj.pstn_feedback = stmt_cm.get_column_string (43);
            obj.pstn_statustext = stmt_cm.get_column_string (44);
            obj.quality_problems = stmt_cm.get_column_string (45);
            obj.quality_status = stmt_cm.get_column_int64 (46);
            obj.real_identity = stmt_cm.get_column_string (47);
            obj.recovery_in_progress = stmt_cm.get_column_int64 (48);
            obj.role = stmt_cm.get_column_string (49);
            obj.seconds_left = stmt_cm.get_column_int64 (50);
            obj.sounderror_code = stmt_cm.get_column_int64 (51);
            obj.soundlevel = stmt_cm.get_column_int64 (52);
            obj.start_timestamp = get_datetime (stmt_cm.get_column_int64 (53));
            obj.stats_xml = stmt_cm.get_column_string (54);
            obj.status = stmt_cm.get_column_int64 (55);
            obj.target_identity = stmt_cm.get_column_string (56);
            obj.tenant_id = stmt_cm.get_column_string (57);
            obj.transfer_active = stmt_cm.get_column_int64 (58);
            obj.transfer_status = stmt_cm.get_column_int64 (59);
            obj.transfer_topic = stmt_cm.get_column_string (60);
            obj.transferred_by = stmt_cm.get_column_string (61);
            obj.transferred_to = stmt_cm.get_column_string (62);
            obj.type = stmt_cm.get_column_int64 (63);
            obj.version_string = stmt_cm.get_column_string (64);
            obj.videostatus = stmt_cm.get_column_int64 (65);
            obj.voicechannel = stmt_cm.get_column_int64 (66);

            // Add callmembers to the list
            call_members.emplace (obj.call_db_id, std::move (obj));
        }

        // Prepare SQL statement for table Calls
        auto stmt = db.new_statement (
            "SELECT ${access_token:66-*},"
            "${active_members:66-*},"
            "${begin_timestamp:66-*},"
            "${broadcast_metadata:97-*},"
            "${conf_participants:66-*},"
            "${content_sharing_session_count_changed:97-*},"
            "${conv_dbid:66-*},"
            "${current_video_audience:66-*},"
            "${duration:66-*},"
            "${failurecode:66-*},"
            "${failurereason:66-*},"
            "${host_identity:66-*},"
            "${id:66-*},"
            "${is_active:66-*},"
            "${is_conference:66-*},"
            "${is_incoming:66-*},"
            "${is_incoming_one_on_one_video_call:97-*},"
            "${is_muted:66-*},"
            "${is_muted_speaker:97-*},"
            "${is_on_hold:66-*},"
            "${is_permanent:66-*},"
            "${is_premium_video_sponsor:66-*},"
            "${is_server_muted:97-*},"
            "${is_unseen_missed:66-*},"
            "${joined_existing:66-*},"
            "${light_weight_meeting_count_changed:97-*},"
            "${meeting_details:97-*},"
            "${members:66-*},"
            "${mike_status:66-*},"
            "${name:66-*},"
            "${old_duration:66-*},"
            "${old_members:66-*},"
            "${partner_dispname:66-*},"
            "${partner_handle:66-*},"
            "${premium_video_is_grace_period:66-*},"
            "${premium_video_sponsor_list:66-*},"
            "${premium_video_status:66-*},"
            "${pstn_number:66-*},"
            "${pstn_status:66-*},"
            "${quality_problems:66-*},"
            "${queue_info:97-*},"
            "${role:97-*},"
            "${server_identity:66-*},"
            "${soundlevel:66-*},"
            "${start_timestamp:66-*},"
            "${status:66-*},"
            "${technology:72-*},"
            "${tenant_id:97-*},"
            "${topic:66-*},"
            "${transferor_displayname:97-*},"
            "${transferor_type:97-*},"
            "${type:66-*},"
            "${vaa_input_status:66-*},"
            "${video_disabled:66-*} "
            "FROM Calls",
            schema_version_
        );

        // Retrieve records from Calls table
        idx = 0;

        while (stmt.fetch_row ())
        {
            call obj;

            obj.idx = idx++;
            obj.access_token = stmt.get_column_string (0);
            obj.active_members = stmt.get_column_int64 (1);
            obj.begin_timestamp = get_datetime (stmt.get_column_int64 (2));
            obj.broadcast_metadata = stmt.get_column_string (3);
            obj.conf_participants = stmt.get_column_bytearray (4);
            obj.content_sharing_session_count_changed =
                stmt.get_column_int64 (5);
            obj.conv_dbid = stmt.get_column_int64 (6);
            obj.current_video_audience = stmt.get_column_string (7);
            obj.duration = stmt.get_column_int64 (8);
            obj.failurecode = stmt.get_column_int64 (9);
            obj.failurereason = stmt.get_column_int64 (10);
            obj.host_identity = stmt.get_column_string (11);
            obj.id = stmt.get_column_int64 (12);
            obj.is_active = stmt.get_column_bool (13);
            obj.is_conference = stmt.get_column_int64 (14) > 0;
            obj.is_incoming = stmt.get_column_bool (15);
            obj.is_incoming_one_on_one_video_call = stmt.get_column_bool (16);
            obj.is_muted = stmt.get_column_bool (17);
            obj.is_muted_speaker = stmt.get_column_bool (18);
            obj.is_on_hold = stmt.get_column_bool (19);
            obj.is_permanent = stmt.get_column_bool (20);
            obj.is_premium_video_sponsor = stmt.get_column_bool (21);
            obj.is_server_muted = stmt.get_column_bool (22);
            obj.is_unseen_missed = stmt.get_column_bool (23);
            obj.joined_existing = stmt.get_column_int64 (24);
            obj.light_weight_meeting_count_changed = stmt.get_column_int64 (25);
            obj.meeting_details = stmt.get_column_string (26);
            obj.members = stmt.get_column_bytearray (27);
            obj.mike_status = stmt.get_column_int64 (28);
            obj.name = stmt.get_column_string (29);
            obj.old_duration = stmt.get_column_int64 (30);
            obj.old_members = stmt.get_column_bytearray (31);
            obj.partner_dispname = stmt.get_column_string (32);
            obj.partner_handle = stmt.get_column_string (33);
            obj.premium_video_is_grace_period = stmt.get_column_int64 (34);
            obj.premium_video_sponsor_list = stmt.get_column_string (35);
            obj.premium_video_status = stmt.get_column_int64 (36);
            obj.pstn_number = stmt.get_column_string (37);
            obj.pstn_status = stmt.get_column_string (38);
            obj.quality_problems = stmt.get_column_string (39);
            obj.queue_info = stmt.get_column_string (40);
            obj.role = stmt.get_column_string (41);
            obj.server_identity = stmt.get_column_string (42);
            obj.soundlevel = stmt.get_column_int64 (43);
            obj.start_timestamp = get_datetime (stmt.get_column_int64 (44));
            obj.status = stmt.get_column_int64 (45);
            obj.technology = stmt.get_column_int64 (46);
            obj.tenant_id = stmt.get_column_string (47);
            obj.topic = stmt.get_column_string (48);
            obj.transferor_displayname = stmt.get_column_string (49);
            obj.transferor_type = stmt.get_column_string (50);
            obj.type = stmt.get_column_int64 (51);
            obj.vaa_input_status = stmt.get_column_int64 (52);
            obj.video_disabled = stmt.get_column_int64 (53);

            // Add call members to the call object
            auto range = call_members.equal_range (obj.id);
            std::transform (
                range.first, range.second,
                std::back_inserter (obj.call_members),
                [] (auto &pair) { return pair.second; }
            );

            // Add call to the list
            calls_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load Contacts
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_contacts (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Contacts table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Contacts
        auto stmt = db.new_statement (
            "SELECT ${about:66-259},"
            "${account_modification_serial_nr:66-259},"
            "${added_in_shared_group:66-259},"
            "${alertstring:66-259},"
            "${aliases:66-259},"
            "${assigned_comment:66-259},"
            "${assigned_phone1:66-259},"
            "${assigned_phone1_label:66-259},"
            "${assigned_phone2:66-259},"
            "${assigned_phone2_label:66-259},"
            "${assigned_phone3:66-259},"
            "${assigned_phone3_label:66-259},"
            "${assigned_speeddial:66-259},"
            "${authorization_certificate:66-259},"
            "${authorized_time:66-259},"
            "${authreq_crc:66-259},"
            "${authreq_history:66-259},"
            "${authreq_initmethod:66-259},"
            "${authreq_nodeinfo:66-259},"
            "${authreq_src:66-259},"
            "${authreq_timestamp:66-259},"
            "${authrequest_count:66-259},"
            "${availability:66-259},"
            "${avatar_image:66-259},"
            "${avatar_timestamp:66-259},"
            "${avatar_url:72-259},"
            "${birthday:66-259},"
            "${buddyblob:66-259},"
            "${buddystatus:66-259},"
            "${capabilities:66-259},"
            "${cbl_future:66-259},"
            "${certificate_send_count:66-259},"
            "${city:66-259},"
            "${contactlist_track:66-259},"
            "${country:66-259},"
            "${displayname:66-259},"
            "${emails:66-259},"
            "${external_id:66-259},"
            "${external_system_id:66-259},"
            "${extprop_external_data:66-259},"
            "${extprop_sms_pstn_contact_created:97-*},"
            "${firstname:72-259},"
            "${fullname:66-259},"
            "${gender:66-259},"
            "${given_authlevel:66-259},"
            "${given_displayname:66-259},"
            "${group_membership:72-259},"
            "${hashed_emails:66-259},"
            "${homepage:66-259},"
            "${id:66-*},"
            "${in_shared_group:66-259},"
            "${ipcountry:66-259},"
            "${is_auto_buddy:72-259},"
            "${is_mobile:72-259},"
            "${is_permanent:66-*},"
            "${is_trusted:72-259},"
            "${isauthorized:66-259},"
            "${isblocked:66-259},"
            "${languages:66-259},"
            "${last_used_networktime:66-259},"
            "${lastname:72-259},"
            "${lastonline_timestamp:66-259},"
            "${lastused_timestamp:66-259},"
            "${liveid_cid:66-259},"
            "${main_phone:66-259},"
            "${mood_text:66-259},"
            "${mood_timestamp:66-259},"
            "${network_availability:72-259},"
            "${node_capabilities:66-259},"
            "${node_capabilities_and:66-259},"
            "${nr_of_buddies:66-259},"
            "${nrof_authed_buddies:66-259},"
            "${offline_authreq_id:66-259},"
            "${phone_home:66-259},"
            "${phone_home_normalized:66-259},"
            "${phone_mobile:66-259},"
            "${phone_mobile_normalized:66-259},"
            "${phone_office:66-259},"
            "${phone_office_normalized:66-259},"
            "${pop_score:66-259},"
            "${popularity_ord:66-259},"
            "${profile_attachments:66-259},"
            "${profile_timestamp:66-259},"
            "${province:66-259},"
            "${pstnnumber:66-259},"
            "${received_authrequest:66-259},"
            "${refreshing:66-259},"
            "${revoked_auth:66-259},"
            "${rich_mood_text:66-259},"
            "${saved_directory_blob:66-259},"
            "${sent_authrequest:66-259},"
            "${sent_authrequest_extrasbitmask:66-259},"
            "${sent_authrequest_initmethod:66-259},"
            "${sent_authrequest_serial:66-259},"
            "${sent_authrequest_time:66-259},"
            "${server_synced:66-259},"
            "${skypename:66-259},"
            "${stack_version:66-259},"
            "${timezone:66-259},"
            "${type:66-259},"
            "${unified_servants:66-259},"
            "${verified_company:66-259},"
            "${verified_email:66-259} "
            "FROM Contacts",
            schema_version_
        );

        // Retrieve records from Contacts table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            contact obj;

            obj.idx = idx++;
            obj.about = stmt.get_column_string (0);
            obj.account_modification_serial_nr = stmt.get_column_int64 (1);
            obj.added_in_shared_group = stmt.get_column_int64 (2);
            obj.alertstring = stmt.get_column_string (3);
            obj.aliases = stmt.get_column_string (4);
            obj.assigned_comment = stmt.get_column_string (5);
            obj.assigned_phone1 = stmt.get_column_string (6);
            obj.assigned_phone1_label = stmt.get_column_string (7);
            obj.assigned_phone2 = stmt.get_column_string (8);
            obj.assigned_phone2_label = stmt.get_column_string (9);
            obj.assigned_phone3 = stmt.get_column_string (10);
            obj.assigned_phone3_label = stmt.get_column_string (11);
            obj.assigned_speeddial = stmt.get_column_string (12);
            obj.authorization_certificate = stmt.get_column_bytearray (13);
            obj.authorized_time = stmt.get_column_int64 (14);
            obj.authreq_crc = stmt.get_column_int64 (15);
            obj.authreq_history = stmt.get_column_bytearray (16);
            obj.authreq_initmethod = stmt.get_column_int64 (17);
            obj.authreq_nodeinfo = stmt.get_column_bytearray (18);
            obj.authreq_src = stmt.get_column_int64 (19);
            obj.authreq_timestamp = stmt.get_column_int64 (20);
            obj.authrequest_count = stmt.get_column_int64 (21);
            obj.availability = stmt.get_column_int64 (22);
            obj.avatar_image = stmt.get_column_bytearray (23);
            obj.avatar_timestamp = get_datetime (stmt.get_column_int64 (24));
            obj.avatar_url = stmt.get_column_string (25);
            obj.birthday = get_birthday (stmt.get_column_int64 (26));
            obj.buddyblob = stmt.get_column_bytearray (27);
            obj.buddystatus = stmt.get_column_int64 (28);
            obj.capabilities = stmt.get_column_bytearray (29);
            obj.cbl_future = stmt.get_column_bytearray (30);
            obj.certificate_send_count = stmt.get_column_int64 (31);
            obj.city = stmt.get_column_string (32);
            obj.contactlist_track = stmt.get_column_int64 (33);
            obj.country = stmt.get_column_string (34);
            obj.displayname = stmt.get_column_string (35);
            obj.emails = stmt.get_column_string (36);
            obj.external_id = stmt.get_column_string (37);
            obj.external_system_id = stmt.get_column_string (38);
            obj.extprop_external_data = stmt.get_column_string (39);
            obj.extprop_sms_pstn_contact_created = stmt.get_column_int64 (40);
            obj.firstname = stmt.get_column_string (41);
            obj.fullname = stmt.get_column_string (42);
            obj.gender = stmt.get_column_int64 (43);
            obj.given_authlevel = stmt.get_column_int64 (44);
            obj.given_displayname = stmt.get_column_string (45);
            obj.group_membership = stmt.get_column_int64 (46);
            obj.hashed_emails = stmt.get_column_string (47);
            obj.homepage = stmt.get_column_string (48);
            obj.id = stmt.get_column_int64 (49);
            obj.in_shared_group = stmt.get_column_int64 (50);
            obj.ipcountry = stmt.get_column_string (51);
            obj.is_auto_buddy = stmt.get_column_bool (52);
            obj.is_mobile = stmt.get_column_bool (53);
            obj.is_permanent = stmt.get_column_bool (54);
            obj.is_trusted = stmt.get_column_bool (55);
            obj.isauthorized = stmt.get_column_bool (56);
            obj.isblocked = stmt.get_column_bool (57);
            obj.languages = stmt.get_column_string (58);
            obj.last_used_networktime = get_time (stmt.get_column_int64 (59));
            obj.lastname = stmt.get_column_string (60);
            obj.lastonline_timestamp =
                get_datetime (stmt.get_column_int64 (61));
            obj.lastused_timestamp = get_datetime (stmt.get_column_int64 (62));
            obj.liveid_cid = stmt.get_column_string (63);
            obj.main_phone = stmt.get_column_string (64);
            obj.mood_text = stmt.get_column_string (65);
            obj.mood_timestamp = get_datetime (stmt.get_column_int64 (66));
            obj.network_availability = stmt.get_column_int64 (67);
            obj.node_capabilities = stmt.get_column_int64 (68);
            obj.node_capabilities_and = stmt.get_column_int64 (69);
            obj.nr_of_buddies = stmt.get_column_int64 (70);
            obj.nrof_authed_buddies = stmt.get_column_int64 (71);
            obj.offline_authreq_id = stmt.get_column_int64 (72);
            obj.phone_home = stmt.get_column_string (73);
            obj.phone_home_normalized = stmt.get_column_string (74);
            obj.phone_mobile = stmt.get_column_string (75);
            obj.phone_mobile_normalized = stmt.get_column_string (76);
            obj.phone_office = stmt.get_column_string (77);
            obj.phone_office_normalized = stmt.get_column_string (78);
            obj.pop_score = stmt.get_column_int64 (79);
            obj.popularity_ord = stmt.get_column_int64 (80);
            obj.profile_attachments = stmt.get_column_bytearray (81);
            obj.profile_timestamp = get_datetime (stmt.get_column_int64 (82));
            obj.province = stmt.get_column_string (83);
            obj.pstnnumber = stmt.get_column_string (84);
            obj.received_authrequest = stmt.get_column_string (85);
            obj.refreshing = stmt.get_column_int64 (86);
            obj.revoked_auth = stmt.get_column_int64 (87);
            obj.rich_mood_text = stmt.get_column_string (88);
            obj.saved_directory_blob = stmt.get_column_bytearray (89);
            obj.sent_authrequest = stmt.get_column_string (90);
            obj.sent_authrequest_extrasbitmask = stmt.get_column_int64 (91);
            obj.sent_authrequest_initmethod = stmt.get_column_int64 (92);
            obj.sent_authrequest_serial = stmt.get_column_int64 (93);
            obj.sent_authrequest_time = stmt.get_column_int64 (94);
            obj.server_synced = stmt.get_column_int64 (95);
            obj.skypename = stmt.get_column_string (96);
            obj.stack_version = stmt.get_column_int64 (97);
            obj.timezone = get_timezone (stmt.get_column_int64 (98));
            obj.type = stmt.get_column_int64 (99);
            obj.unified_servants = stmt.get_column_string (100);
            obj.verified_company = stmt.get_column_bytearray (101);
            obj.verified_email = stmt.get_column_bytearray (102);

            // Add contacts to the list
            contacts_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load File Transfers
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_file_transfers (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Transfers table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Transfers
        auto stmt = db.new_statement (
            "SELECT accepttime,"
            "bytespersecond,"
            "bytestransferred,"
            "chatmsg_guid,"
            "chatmsg_index,"
            "convo_id,"
            "failurereason,"
            "filename,"
            "filepath,"
            "filesize,"
            "finishtime,"
            "flags,"
            "id,"
            "is_permanent,"
            "last_activity,"
            "nodeid,"
            "old_filepath,"
            "old_status,"
            "partner_dispname,"
            "partner_handle,"
            "pk_id,"
            "starttime,"
            "status,"
            "type "
            "FROM Transfers",
            schema_version_
        );

        // Retrieve records from Transfers table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            file_transfer obj;

            obj.idx = idx++;
            obj.accepttime = get_datetime (stmt.get_column_int64 (0));
            obj.bytespersecond = stmt.get_column_int64 (1);
            obj.bytestransferred = stmt.get_column_string (2);
            obj.chatmsg_guid = stmt.get_column_bytearray (3).to_guid ();
            obj.chatmsg_index = stmt.get_column_int64 (4);
            obj.convo_id = stmt.get_column_int64 (5);
            obj.failurereason = stmt.get_column_int64 (6);
            obj.filename = stmt.get_column_string (7);
            obj.filepath = stmt.get_column_string (8);
            obj.filesize = stmt.get_column_string (9);
            obj.finishtime = get_datetime (stmt.get_column_int64 (10));
            obj.flags = stmt.get_column_int64 (11);
            obj.id = stmt.get_column_int64 (12);
            obj.is_permanent = stmt.get_column_bool (13);
            obj.last_activity = stmt.get_column_int64 (14);
            obj.nodeid = stmt.get_column_bytearray (15);
            obj.old_filepath = stmt.get_column_int64 (16);
            obj.old_status = stmt.get_column_int64 (17);
            obj.partner_dispname = stmt.get_column_string (18);
            obj.partner_handle = stmt.get_column_string (19);
            obj.pk_id = stmt.get_column_int64 (20);
            obj.starttime = get_datetime (stmt.get_column_int64 (21));
            obj.status = stmt.get_column_int64 (22);
            obj.type = stmt.get_column_int64 (23);

            // Add transfers to the list
            file_transfers_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load SMSes
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_sms (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // SMSes table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table SMSes
        auto stmt = db.new_statement (
                "SELECT ${body:0-259},"
                       "${chatmsg_id:0-259},"
                       "${convo_name:66-259},"
                       "${error_category:67-259},"
                       "${event_flags:0-259},"
                       "${failurereason:0-259},"
                       "${id:0-308},"
                       "${identity:0-259},"
                       "${is_failed_unseen:0-259},"
                       "${is_permanent:0-308},"
                       "${notification_id:66-259},"
                       "${outgoing_reply_type:66-259},"
                       "${price:0-259},"
                       "${price_currency:0-259},"
                       "${price_precision:0-259},"
                       "${reply_id_number:66-259},"
                       "${reply_to_number:0-259},"
                       "${status:0-259},"
                       "${target_numbers:0-259},"
                       "${target_statuses:0-259},"
                       "${timestamp:0-259},"
                       "${type:0-259} "
                  "FROM SMSes",
                schema_version_
        );

        // Retrieve records from SMSes table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            sms obj;

            obj.idx = idx++;
            obj.body = stmt.get_column_string (0);
            obj.chatmsg_id = stmt.get_column_int64 (1);
            obj.convo_name = stmt.get_column_string (2);
            obj.error_category = stmt.get_column_int64 (3);
            obj.event_flags = stmt.get_column_int64 (4);
            obj.failurereason = stmt.get_column_int64 (5);
            obj.id = stmt.get_column_int64 (6);
            obj.identity = stmt.get_column_string (7);
            obj.is_failed_unseen = stmt.get_column_bool (8);
            obj.is_permanent = stmt.get_column_bool (9);
            obj.notification_id = stmt.get_column_int64 (10);
            obj.outgoing_reply_type = stmt.get_column_int64 (11);
            obj.price = stmt.get_column_int64 (12);
            obj.price_currency = stmt.get_column_string (13);
            obj.price_precision = stmt.get_column_int64 (14);
            obj.reply_id_number = stmt.get_column_string (15);
            obj.reply_to_number = stmt.get_column_string (16);
            obj.status = stmt.get_column_int64 (17);
            obj.target_numbers = stmt.get_column_string (18);
            obj.target_statuses = stmt.get_column_bytearray (19);
            obj.timestamp = get_datetime(stmt.get_column_int64 (20));
            obj.type = stmt.get_column_int64 (21);

            // Add smses to the list
            sms_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load Voicemails
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_voicemails (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Voicemails table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Voicemails
        auto stmt = db.new_statement (
            "SELECT allowed_duration,"
            "chatmsg_guid,"
            "convo_id,"
            "duration,"
            "failurereason,"
            "failures,"
            "flags,"
            "id,"
            "is_permanent,"
            "notification_id,"
            "partner_dispname,"
            "partner_handle,"
            "path,"
            "playback_progress,"
            "size,"
            "status,"
            "subject,"
            "timestamp,"
            "type,"
            "vflags,"
            "xmsg "
            "FROM Voicemails"
        );

        // Retrieve records from Voicemails table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            voicemail obj;

            obj.idx = idx++;
            obj.allowed_duration = stmt.get_column_int64 (0);
            obj.chatmsg_guid = stmt.get_column_bytearray (1).to_guid ();
            obj.convo_id = stmt.get_column_int64 (2);
            obj.duration = stmt.get_column_int64 (3);
            obj.failurereason = stmt.get_column_int64 (4);
            obj.failures = stmt.get_column_int64 (5);
            obj.flags = stmt.get_column_int64 (6);
            obj.id = stmt.get_column_int64 (7);
            obj.is_permanent = stmt.get_column_bool (8);
            obj.notification_id = stmt.get_column_int64 (9);
            obj.partner_dispname = stmt.get_column_string (10);
            obj.partner_handle = stmt.get_column_string (11);
            obj.path = stmt.get_column_string (12);
            obj.playback_progress = stmt.get_column_int64 (13);
            obj.size = stmt.get_column_int64 (14);
            obj.status = stmt.get_column_int64 (15);
            obj.subject = stmt.get_column_string (16);
            obj.timestamp = get_datetime (stmt.get_column_int64 (17));
            obj.type = stmt.get_column_int64 (18);
            obj.vflags = stmt.get_column_int64 (19);
            obj.xmsg = stmt.get_column_string (20);

            // Add voicemails to the list
            voicemails_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

} // namespace mobius::extension::app::skype
