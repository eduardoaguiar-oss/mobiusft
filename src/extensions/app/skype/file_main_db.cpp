// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// Mobius Forensic Toolkit
// Copyright (C)
// 2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025
// Eduardo Aguiar
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the
// Free Software Foundation; either version 2, or (at your option) any later
// version.
//
// This program is distributed in the hope that it will be useful, but
// WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General
// Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program. If not, see <http://www.gnu.org/licenses/>.
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#include "file_main_db.hpp"
#include <mobius/core/database/database.hpp>
#include <mobius/core/datetime/datetime.hpp>
#include <mobius/core/io/tempfile.hpp>
#include <mobius/core/log.hpp>
#include <mobius/core/string_functions.hpp>
#include <format>
#include <limits>
#include <unordered_set>
#include "common.hpp"

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// References:
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// main.db file tables
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//
// - Accounts
//      - about: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - ad_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - added_in_shared_group: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - alertstring: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - aliases: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - assigned_comment: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - assigned_speeddial: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authorized_time: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authreq_history: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authreq_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authrequest_count: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - authrequest_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - availability: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_image: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - avatar_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - birthday: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - buddyblob: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - buddycount_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - capabilities: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cbl_future: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cblsyncstatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - chat_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - city: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - cobrand_id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - commitstatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - country: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - displayname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - emails: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - federated_presence_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - flamingo_xmpp_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - fullname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - gender: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - given_authlevel: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - given_displayname: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - homepage: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - in_shared_group: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - ipcountry: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - languages: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - lastonline_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - lastused_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - liveid_membername: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - logoutreason: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - mood_text: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - mood_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - node_capabilities: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - node_capabilities_and: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nr_of_other_instances: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - nrof_authed_buddies: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - offline_authreq_id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - offline_callforward: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - option_ui_color: 97, 100, 141, 168, 308
//      - options_change_future: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - owner_under_legal_age: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_channel_status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - partner_optedout: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_home: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_mobile: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phone_office: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - phonenumbers_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - profile_attachments: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - profile_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - province: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstn_call_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pstnnumber: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - pwdchangestatus: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - received_authrequest: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - refreshing: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - registration_timestamp: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - revoked_auth: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - rich_mood_text: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - roaming_history_enabled: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest_serial: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - sent_authrequest_time: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - service_provider_info: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - set_availability: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - shortcircuit_sync: 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skype_call_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypein_numbers: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypename: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_balance: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_balance_currency: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - skypeout_precision: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - stack_version: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - status: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - subscriptions: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - suggested_skypename: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - synced_email: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - timezone: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - timezone_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - type: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - uses_jcs: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - verified_company: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - verified_email: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - voicemail_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - webpresence_policy: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//
// - Contacts
//      - about: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - account_modification_serial_nr: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - added_in_shared_group: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - alertstring: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - aliases: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_comment: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone1: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone1_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone2: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone2_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone3: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_phone3_label: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - assigned_speeddial: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authorization_certificate: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authorized_time: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_crc: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_history: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_initmethod: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_nodeinfo: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_src: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authreq_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - authrequest_count: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - availability: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_hiresurl: 81, 84, 141, 162, 209, 235, 259
//      - avatar_hiresurl_new: 81, 84, 141, 162, 209, 235, 259
//      - avatar_image: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - avatar_url: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - avatar_url_new: 81, 84, 133, 141, 149, 162, 209, 235, 259
//      - birthday: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - buddyblob: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - buddystatus: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - capabilities: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - cbl_future: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - certificate_send_count: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - city: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - contactlist_track: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - country: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - dirblob_last_search_time: 84, 141, 162, 209, 235, 259
//      - displayname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - emails: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - external_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - external_system_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_external_data: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_must_hide_avatar: 66
//      - extprop_seen_birthday: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_sms_pstn_contact_created: 97, 100, 141, 168, 308
//      - extprop_sms_target: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - firstname: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - fullname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - gender: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - given_authlevel: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - given_displayname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - group_membership: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - hashed_emails: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - homepage: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - in_shared_group: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - ipcountry: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - is_auto_buddy: 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152, 162, 164, 196, 209, 235, 259
//      - is_mobile: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_trusted: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - isauthorized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - isblocked: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - languages: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - last_used_networktime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - lastname: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - lastonline_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - lastused_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - liveid_cid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - main_phone: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - mood_text: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - mood_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - mutual_friend_count: 84, 141, 162, 209, 235, 259
//      - network_availability: 72, 77, 81, 84-85, 133, 141, 149, 162, 164, 209, 235, 259
//      - node_capabilities: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - node_capabilities_and: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nr_of_buddies: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nrof_authed_buddies: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - offline_authreq_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_home: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_home_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_mobile: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_mobile_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_office: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - phone_office_normalized: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pop_score: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - popularity_ord: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - profile_attachments: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - profile_etag: 84, 141, 162, 209, 235, 259
//      - profile_json: 84, 141, 162, 209, 235, 259
//      - profile_timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - province: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pstnnumber: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - received_authrequest: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - refreshing: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - revoked_auth: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - rich_mood_text: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - saved_directory_blob: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_extrasbitmask: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_initmethod: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_serial: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - sent_authrequest_time: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - server_synced: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - skypename: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - stack_version: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - timezone: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - unified_servants: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - verified_company: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - verified_email: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 141, 149, 152-153, 162, 164, 196, 209, 235, 259
//
// - Transfers
//      - accepttime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - bytespersecond: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - bytestransferred: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_guid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_index: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - convo_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_handled_by_chat: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_hide_from_history: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_localfilename: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_window_visible: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failurereason: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filename: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filepath: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - filesize: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - finishtime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - flags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - last_activity: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - nodeid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - offer_send_list: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - old_filepath: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - old_status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - parent_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_dispname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_handle: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - pk_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - starttime: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//
// - Voicemails
//      - allowed_duration: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - chatmsg_guid: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - convo_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - duration: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - extprop_hide_from_history: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failurereason: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - failures: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - flags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - id: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - is_permanent: 66-67, 72, 77, 81, 84-85, 97, 100, 107, 114, 133, 141, 149, 152-153, 162, 164, 168, 196, 209, 235, 259, 308
//      - notification_id: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_dispname: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - partner_handle: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - path: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - playback_progress: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - size: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - status: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - subject: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - timestamp: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - type: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - vflags: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
//      - xmsg: 66-67, 72, 77, 81, 84-85, 107, 114, 133, 149, 152-153, 162, 164, 196, 209, 235, 259
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

namespace
{
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// Constants
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief DEBUG flag
static constexpr bool DEBUG = false;

// @brief Last known schema version
static constexpr std::int64_t LAST_KNOWN_SCHEMA_VERSION = 308;

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Unknown schema versions
// This set contains schema versions that are not recognized or not handled
// by the current implementation. It is used to identify unsupported versions
// of the main.db schema in Skype applications.
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
static std::unordered_set<std::int64_t> UNKNOWN_SCHEMA_VERSIONS = {
    1,   2,   3,   4,   5,   6,   7,   8,   9,   10,  11,  12,  13,  14,  15,
    16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,
    31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,  42,  43,  44,  45,
    46,  47,  48,  49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59,  60,
    61,  62,  63,  64,  65,  68,  69,  70,  71,  73,  74,  75,  76,  78,  79,
    80,  82,  83,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96,  98,
    99,  101, 102, 103, 104, 105, 106, 108, 109, 110, 111, 112, 113, 115, 116,
    117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131,
    132, 134, 135, 136, 137, 138, 139, 140, 142, 143, 144, 145, 146, 147, 148,
    150, 151, 154, 155, 156, 157, 158, 159, 160, 161, 163, 165, 166, 167, 169,
    170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184,
    185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 197, 198, 199, 200,
    201, 202, 203, 204, 205, 206, 207, 208, 210, 211, 212, 213, 214, 215, 216,
    217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231,
    232, 233, 234, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247,
    248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 260, 261, 262, 263,
    264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278,
    279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293,
    294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307,
};

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Get database schema version
// @param db Database object
// @return Schema version or 0 if not found
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
static std::int64_t
get_db_schema_version (mobius::core::database::database &db)
{
    std::int64_t schema_version = 0;

    mobius::core::log log (__FILE__, __FUNCTION__);

    try
    {
        if (!db.has_table ("AppSchemaVersion"))
        {
            log.info (
                __LINE__,
                "AppSchemaVersion table not found. Path: " + db.get_path ()
            );
            return 0;
        }

        auto stmt = db.new_statement (
            "SELECT SQLiteSchemaVersion FROM AppSchemaVersion"
        );

        if (stmt.fetch_row ())
        {
            schema_version = stmt.get_column_int64 (0);

            if (!schema_version)
            {
                log.warning (
                    __LINE__, "Schema version = 0. Path: " + db.get_path ()
                );
            }
        }
        else
        {
            log.warning (
                __LINE__,
                "Schema version not found in AppSchemaVersion table. Path: " +
                    db.get_path ()
            );
        }
    }
    catch (const std::exception &e)
    {
        log.warning (
            __LINE__, std::string (e.what ()) + ". Path: " + db.get_path ()
        );
    }

    return schema_version;
}

} // namespace

namespace mobius::extension::app::skype
{
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Constructor
// @param reader Reader object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
file_main_db::file_main_db (const mobius::core::io::reader &reader)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    if (!reader)
        return;

    try
    {
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Copy reader content to temporary file
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        mobius::core::io::tempfile tfile;
        tfile.copy_from (reader);

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Get schema version
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        mobius::core::database::database db (tfile.get_path ());
        schema_version_ = get_db_schema_version (db);

        if (schema_version_ > LAST_KNOWN_SCHEMA_VERSION ||
            UNKNOWN_SCHEMA_VERSIONS.find (schema_version_) !=
                UNKNOWN_SCHEMA_VERSIONS.end ())
        {
            log.development (
                __LINE__,
                "Unhandled schema version: " + std::to_string (schema_version_)
            );
        }

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Load data
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        _load_accounts (db);
        _load_contacts (db);
        _load_file_transfers (db);
        _load_voicemails (db);

        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        // Finish decoding
        // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
        is_instance_ = true;
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load accounts
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_accounts (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    try
    {
        auto stmt = db.new_statement (
            "SELECT about, "
            "ad_policy, "
            "added_in_shared_group, "
            "alertstring, "
            "aliases, "
            "assigned_comment, "
            "assigned_speeddial, "
            "authorized_time, "
            "authreq_history, "
            "authreq_timestamp, "
            "authrequest_count, "
            "authrequest_policy, "
            "availability, "
            "avatar_image, "
            "avatar_policy, "
            "avatar_timestamp, "
            "birthday, "
            "buddyblob, "
            "buddycount_policy, "
            "capabilities, "
            "cbl_future, "
            "cblsyncstatus, "
            "chat_policy, "
            "city, "
            "${cobrand_id:1}, "
            "commitstatus, "
            "country, "
            "displayname, "
            "emails, "
            "${federated_presence_policy:1}, "
            "${flamingo_xmpp_status:1}, "
            "fullname, "
            "gender, "
            "given_authlevel, "
            "given_displayname, "
            "homepage, "
            "id, "
            "in_shared_group, "
            "ipcountry, "
            "is_permanent, "
            "languages, "
            "lastonline_timestamp, "
            "lastused_timestamp, "
            "${liveid_membername:1}, "
            "logoutreason, "
            "mood_text, "
            "mood_timestamp, "
            "node_capabilities, "
            "node_capabilities_and, "
            "nr_of_other_instances, "
            "nrof_authed_buddies, "
            "offline_authreq_id, "
            "offline_callforward, "
            "${options_change_future:1}, "
            "owner_under_legal_age, "
            "${partner_channel_status:1}, "
            "partner_optedout, "
            "phone_home, "
            "phone_mobile, "
            "phone_office, "
            "phonenumbers_policy, "
            "profile_attachments, "
            "profile_timestamp, "
            "province, "
            "pstn_call_policy, "
            "pstnnumber, "
            "pwdchangestatus, "
            "received_authrequest, "
            "refreshing, "
            "registration_timestamp, "
            "revoked_auth, "
            "rich_mood_text, "
            "${roaming_history_enabled:1}, "
            "sent_authrequest, "
            "sent_authrequest_serial, "
            "sent_authrequest_time, "
            "service_provider_info, "
            "set_availability, "
            "${shortcircuit_sync:72}, "
            "skype_call_policy, "
            "skypein_numbers, "
            "skypename, "
            "skypeout_balance, "
            "skypeout_balance_currency, "
            "skypeout_precision, "
            "stack_version, "
            "status, "
            "subscriptions, "
            "suggested_skypename, "
            "synced_email, "
            "timezone, "
            "timezone_policy, "
            "type, "
            "${uses_jcs:1}, "
            "${verified_company:1}, "
            "${verified_email:1}, "
            "voicemail_policy, "
            "webpresence_policy "
            "FROM accounts",
            schema_version_
        );

        // Retrieve rows from query
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            account a;

            // Set attributes
            a.idx = idx++;
            a.schema_version = schema_version_;
            a.about = stmt.get_column_string (0);
            a.ad_policy = stmt.get_column_int64 (1);
            a.added_in_shared_group = stmt.get_column_int64 (2);
            a.alertstring = stmt.get_column_string (3);
            a.aliases = stmt.get_column_string (4);
            a.assigned_comment = stmt.get_column_string (5);
            a.assigned_speeddial = stmt.get_column_string (6);
            a.authorized_time = stmt.get_column_int64 (7);
            a.authreq_history = stmt.get_column_bytearray (8);
            a.authreq_timestamp = get_datetime (stmt.get_column_int64 (9));
            a.authrequest_count = stmt.get_column_int64 (10);
            a.authrequest_policy = stmt.get_column_int64 (11);
            a.availability = stmt.get_column_int64 (12);
            a.avatar_image = stmt.get_column_bytearray (13);
            a.avatar_policy = stmt.get_column_int64 (14);
            a.avatar_timestamp = get_datetime (stmt.get_column_int64 (15));
            a.birthday = get_birthday (stmt.get_column_int64 (16));
            a.buddyblob = stmt.get_column_bytearray (17);
            a.buddycount_policy = stmt.get_column_int64 (18);
            a.capabilities = stmt.get_column_bytearray (19);
            a.cbl_future = stmt.get_column_bytearray (20);
            a.cblsyncstatus = stmt.get_column_int64 (21);
            a.chat_policy = stmt.get_column_int64 (22);
            a.city = stmt.get_column_string (23);
            a.cobrand_id = stmt.get_column_int64 (24);
            a.commitstatus = stmt.get_column_int64 (25);
            a.country = stmt.get_column_string (26);
            a.displayname = stmt.get_column_string (27);
            a.emails = stmt.get_column_string (28);
            a.federated_presence_policy = stmt.get_column_int64 (29);
            a.flamingo_xmpp_status = stmt.get_column_int64 (30);
            a.fullname = stmt.get_column_string (31);
            a.gender = stmt.get_column_int64 (32);
            a.given_authlevel = stmt.get_column_int64 (33);
            a.given_displayname = stmt.get_column_string (34);
            a.homepage = stmt.get_column_string (35);
            a.id = stmt.get_column_int64 (36);
            a.in_shared_group = stmt.get_column_int64 (37);
            a.ipcountry = stmt.get_column_string (38);
            a.is_permanent = stmt.get_column_bool (39);
            a.languages = stmt.get_column_string (40);
            a.lastonline_timestamp = get_datetime (stmt.get_column_int64 (41));
            a.lastused_timestamp = get_datetime (stmt.get_column_int64 (42));
            a.liveid_membername = stmt.get_column_string (43);
            a.logoutreason = stmt.get_column_int64 (44);
            a.mood_text = stmt.get_column_string (45);
            a.mood_timestamp = get_datetime (stmt.get_column_int64 (46));
            a.node_capabilities = stmt.get_column_int64 (47);
            a.node_capabilities_and = stmt.get_column_int64 (48);
            a.nr_of_other_instances = stmt.get_column_int64 (49);
            a.nrof_authed_buddies = stmt.get_column_int64 (50);
            a.offline_authreq_id = stmt.get_column_int64 (51);
            a.offline_callforward = stmt.get_column_string (52);
            a.options_change_future = stmt.get_column_bytearray (53);
            a.owner_under_legal_age = stmt.get_column_int64 (54);
            a.partner_channel_status = stmt.get_column_string (55);
            a.partner_optedout = stmt.get_column_string (56);
            a.phone_home = stmt.get_column_string (57);
            a.phone_mobile = stmt.get_column_string (58);
            a.phone_office = stmt.get_column_string (59);
            a.phonenumbers_policy = stmt.get_column_int64 (60);
            a.profile_attachments = stmt.get_column_bytearray (61);
            a.profile_timestamp = get_datetime (stmt.get_column_int64 (62));
            a.province = stmt.get_column_string (63);
            a.pstn_call_policy = stmt.get_column_int64 (64);
            a.pstnnumber = stmt.get_column_string (65);
            a.pwdchangestatus = stmt.get_column_int64 (66);
            a.received_authrequest = stmt.get_column_string (67);
            a.refreshing = stmt.get_column_int64 (68);
            a.registration_timestamp =
                get_datetime (stmt.get_column_int64 (69) * 60);
            a.revoked_auth = stmt.get_column_int64 (70);
            a.rich_mood_text = stmt.get_column_string (71);
            a.roaming_history_enabled = stmt.get_column_bool (72);
            a.sent_authrequest = stmt.get_column_string (73);
            a.sent_authrequest_serial = stmt.get_column_int64 (74);
            a.sent_authrequest_time = stmt.get_column_int64 (75);
            a.service_provider_info = stmt.get_column_string (76);
            a.set_availability = stmt.get_column_int64 (77);
            a.shortcircuit_sync = stmt.get_column_int64 (78);
            a.skype_call_policy = stmt.get_column_int64 (79);
            a.skypein_numbers = stmt.get_column_string (80);
            a.skypename = stmt.get_column_string (81);
            a.skypeout_balance = stmt.get_column_int64 (82);
            a.skypeout_balance_currency = stmt.get_column_string (83);
            a.skypeout_precision = stmt.get_column_int64 (84);
            a.stack_version = stmt.get_column_int64 (85);
            a.status = stmt.get_column_int64 (86);
            a.subscriptions = stmt.get_column_string (87);
            a.suggested_skypename = stmt.get_column_string (88);
            a.synced_email = stmt.get_column_bytearray (89);
            a.timezone = get_timezone (stmt.get_column_int64 (90));
            a.timezone_policy = stmt.get_column_int64 (91);
            a.type = stmt.get_column_int64 (92);
            a.uses_jcs = stmt.get_column_int64 (93);
            a.verified_company = stmt.get_column_bytearray (94);
            a.verified_email = stmt.get_column_bytearray (95);
            a.voicemail_policy = stmt.get_column_int64 (96);
            a.webpresence_policy = stmt.get_column_int64 (97);

            // Add to accounts vector
            accounts_.emplace_back (std::move (a));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load Contacts
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_contacts (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Contacts table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Contacts
        auto stmt = db.new_statement (
            "SELECT ${about:66-259},"
            "${account_modification_serial_nr:66-259},"
            "${added_in_shared_group:66-259},"
            "${alertstring:66-259},"
            "${aliases:66-259},"
            "${assigned_comment:66-259},"
            "${assigned_phone1:66-259},"
            "${assigned_phone1_label:66-259},"
            "${assigned_phone2:66-259},"
            "${assigned_phone2_label:66-259},"
            "${assigned_phone3:66-259},"
            "${assigned_phone3_label:66-259},"
            "${assigned_speeddial:66-259},"
            "${authorization_certificate:66-259},"
            "${authorized_time:66-259},"
            "${authreq_crc:66-259},"
            "${authreq_history:66-259},"
            "${authreq_initmethod:66-259},"
            "${authreq_nodeinfo:66-259},"
            "${authreq_src:66-259},"
            "${authreq_timestamp:66-259},"
            "${authrequest_count:66-259},"
            "${availability:66-259},"
            "${avatar_hiresurl:81-259},"
            "${avatar_hiresurl_new:81-259},"
            "${avatar_image:66-259},"
            "${avatar_timestamp:66-259},"
            "${avatar_url:72-259},"
            "${avatar_url_new:81-259},"
            "${birthday:66-259},"
            "${buddyblob:66-259},"
            "${buddystatus:66-259},"
            "${capabilities:66-259},"
            "${cbl_future:66-259},"
            "${certificate_send_count:66-259},"
            "${city:66-259},"
            "${contactlist_track:66-259},"
            "${country:66-259},"
            "${dirblob_last_search_time:84-259},"
            "${displayname:66-259},"
            "${emails:66-259},"
            "${external_id:66-259},"
            "${external_system_id:66-259},"
            "${extprop_external_data:66-259},"
            "${extprop_must_hide_avatar:66-66},"
            "${extprop_seen_birthday:66-259},"
            "${extprop_sms_pstn_contact_created:97-308},"
            "${extprop_sms_target:66-259},"
            "${firstname:72-259},"
            "${fullname:66-259},"
            "${gender:66-259},"
            "${given_authlevel:66-259},"
            "${given_displayname:66-259},"
            "${group_membership:72-259},"
            "${hashed_emails:66-259},"
            "${homepage:66-259},"
            "${id:66-308},"
            "${in_shared_group:66-259},"
            "${ipcountry:66-259},"
            "${is_auto_buddy:72-259},"
            "${is_mobile:72-259},"
            "${is_permanent:66-308},"
            "${is_trusted:72-259},"
            "${isauthorized:66-259},"
            "${isblocked:66-259},"
            "${languages:66-259},"
            "${last_used_networktime:66-259},"
            "${lastname:72-259},"
            "${lastonline_timestamp:66-259},"
            "${lastused_timestamp:66-259},"
            "${liveid_cid:66-259},"
            "${main_phone:66-259},"
            "${mood_text:66-259},"
            "${mood_timestamp:66-259},"
            "${mutual_friend_count:84-259},"
            "${network_availability:72-259},"
            "${node_capabilities:66-259},"
            "${node_capabilities_and:66-259},"
            "${nr_of_buddies:66-259},"
            "${nrof_authed_buddies:66-259},"
            "${offline_authreq_id:66-259},"
            "${phone_home:66-259},"
            "${phone_home_normalized:66-259},"
            "${phone_mobile:66-259},"
            "${phone_mobile_normalized:66-259},"
            "${phone_office:66-259},"
            "${phone_office_normalized:66-259},"
            "${pop_score:66-259},"
            "${popularity_ord:66-259},"
            "${profile_attachments:66-259},"
            "${profile_etag:84-259},"
            "${profile_json:84-259},"
            "${profile_timestamp:66-259},"
            "${province:66-259},"
            "${pstnnumber:66-259},"
            "${received_authrequest:66-259},"
            "${refreshing:66-259},"
            "${revoked_auth:66-259},"
            "${rich_mood_text:66-259},"
            "${saved_directory_blob:66-259},"
            "${sent_authrequest:66-259},"
            "${sent_authrequest_extrasbitmask:66-259},"
            "${sent_authrequest_initmethod:66-259},"
            "${sent_authrequest_serial:66-259},"
            "${sent_authrequest_time:66-259},"
            "${server_synced:66-259},"
            "${skypename:66-259},"
            "${stack_version:66-259},"
            "${timezone:66-259},"
            "${type:66-259},"
            "${unified_servants:66-259},"
            "${verified_company:66-259},"
            "${verified_email:66-259} "
            "FROM Contacts",
            schema_version_
        );

        // Retrieve records from Contacts table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            contact obj;

            obj.idx = idx++;
            obj.about = stmt.get_column_string (0);
            obj.account_modification_serial_nr = stmt.get_column_int64 (1);
            obj.added_in_shared_group = stmt.get_column_int64 (2);
            obj.alertstring = stmt.get_column_string (3);
            obj.aliases = stmt.get_column_string (4);
            obj.assigned_comment = stmt.get_column_string (5);
            obj.assigned_phone1 = stmt.get_column_string (6);
            obj.assigned_phone1_label = stmt.get_column_string (7);
            obj.assigned_phone2 = stmt.get_column_string (8);
            obj.assigned_phone2_label = stmt.get_column_string (9);
            obj.assigned_phone3 = stmt.get_column_string (10);
            obj.assigned_phone3_label = stmt.get_column_string (11);
            obj.assigned_speeddial = stmt.get_column_string (12);
            obj.authorization_certificate = stmt.get_column_bytearray (13);
            obj.authorized_time = stmt.get_column_int64 (14);
            obj.authreq_crc = stmt.get_column_int64 (15);
            obj.authreq_history = stmt.get_column_bytearray (16);
            obj.authreq_initmethod = stmt.get_column_int64 (17);
            obj.authreq_nodeinfo = stmt.get_column_bytearray (18);
            obj.authreq_src = stmt.get_column_int64 (19);
            obj.authreq_timestamp = stmt.get_column_int64 (20);
            obj.authrequest_count = stmt.get_column_int64 (21);
            obj.availability = stmt.get_column_int64 (22);
            obj.avatar_hiresurl = stmt.get_column_string (23);
            obj.avatar_hiresurl_new = stmt.get_column_string (24);
            obj.avatar_image = stmt.get_column_bytearray (25);
            obj.avatar_timestamp = get_datetime (stmt.get_column_int64 (26));
            obj.avatar_url = stmt.get_column_string (27);
            obj.avatar_url_new = stmt.get_column_string (28);
            obj.birthday = get_birthday (stmt.get_column_int64 (29));
            obj.buddyblob = stmt.get_column_bytearray (30);
            obj.buddystatus = stmt.get_column_int64 (31);
            obj.capabilities = stmt.get_column_bytearray (32);
            obj.cbl_future = stmt.get_column_bytearray (33);
            obj.certificate_send_count = stmt.get_column_int64 (34);
            obj.city = stmt.get_column_string (35);
            obj.contactlist_track = stmt.get_column_int64 (36);
            obj.country = stmt.get_column_string (37);
            obj.dirblob_last_search_time = stmt.get_column_int64 (38);
            obj.displayname = stmt.get_column_string (39);
            obj.emails = stmt.get_column_string (40);
            obj.external_id = stmt.get_column_string (41);
            obj.external_system_id = stmt.get_column_string (42);
            obj.extprop_external_data = stmt.get_column_string (43);
            obj.extprop_must_hide_avatar = stmt.get_column_int64 (44);
            obj.extprop_seen_birthday = stmt.get_column_int64 (45);
            obj.extprop_sms_pstn_contact_created = stmt.get_column_int64 (46);
            obj.extprop_sms_target = stmt.get_column_int64 (47);
            obj.firstname = stmt.get_column_string (48);
            obj.fullname = stmt.get_column_string (49);
            obj.gender = stmt.get_column_int64 (50);
            obj.given_authlevel = stmt.get_column_int64 (51);
            obj.given_displayname = stmt.get_column_string (52);
            obj.group_membership = stmt.get_column_int64 (53);
            obj.hashed_emails = stmt.get_column_string (54);
            obj.homepage = stmt.get_column_string (55);
            obj.id = stmt.get_column_int64 (56);
            obj.in_shared_group = stmt.get_column_int64 (57);
            obj.ipcountry = stmt.get_column_string (58);
            obj.is_auto_buddy = stmt.get_column_bool (59);
            obj.is_mobile = stmt.get_column_bool (60);
            obj.is_permanent = stmt.get_column_bool (61);
            obj.is_trusted = stmt.get_column_bool (62);
            obj.isauthorized = stmt.get_column_bool (63);
            obj.isblocked = stmt.get_column_bool (64);
            obj.languages = stmt.get_column_string (65);
            obj.last_used_networktime = get_time (stmt.get_column_int64 (66));
            obj.lastname = stmt.get_column_string (67);
            obj.lastonline_timestamp =
                get_datetime (stmt.get_column_int64 (68));
            obj.lastused_timestamp = get_datetime (stmt.get_column_int64 (69));
            obj.liveid_cid = stmt.get_column_string (70);
            obj.main_phone = stmt.get_column_string (71);
            obj.mood_text = stmt.get_column_string (72);
            obj.mood_timestamp = get_datetime (stmt.get_column_int64 (73));
            obj.mutual_friend_count = stmt.get_column_int64 (74);
            obj.network_availability = stmt.get_column_int64 (75);
            obj.node_capabilities = stmt.get_column_int64 (76);
            obj.node_capabilities_and = stmt.get_column_int64 (77);
            obj.nr_of_buddies = stmt.get_column_int64 (78);
            obj.nrof_authed_buddies = stmt.get_column_int64 (79);
            obj.offline_authreq_id = stmt.get_column_int64 (80);
            obj.phone_home = stmt.get_column_string (81);
            obj.phone_home_normalized = stmt.get_column_string (82);
            obj.phone_mobile = stmt.get_column_string (83);
            obj.phone_mobile_normalized = stmt.get_column_string (84);
            obj.phone_office = stmt.get_column_string (85);
            obj.phone_office_normalized = stmt.get_column_string (86);
            obj.pop_score = stmt.get_column_int64 (87);
            obj.popularity_ord = stmt.get_column_int64 (88);
            obj.profile_attachments = stmt.get_column_bytearray (89);
            obj.profile_etag = stmt.get_column_string (90);
            obj.profile_json = stmt.get_column_string (91);
            obj.profile_timestamp = get_datetime (stmt.get_column_int64 (92));
            obj.province = stmt.get_column_string (93);
            obj.pstnnumber = stmt.get_column_string (94);
            obj.received_authrequest = stmt.get_column_string (95);
            obj.refreshing = stmt.get_column_int64 (96);
            obj.revoked_auth = stmt.get_column_int64 (97);
            obj.rich_mood_text = stmt.get_column_string (98);
            obj.saved_directory_blob = stmt.get_column_bytearray (99);
            obj.sent_authrequest = stmt.get_column_string (100);
            obj.sent_authrequest_extrasbitmask = stmt.get_column_int64 (101);
            obj.sent_authrequest_initmethod = stmt.get_column_int64 (102);
            obj.sent_authrequest_serial = stmt.get_column_int64 (103);
            obj.sent_authrequest_time = stmt.get_column_int64 (104);
            obj.server_synced = stmt.get_column_int64 (105);
            obj.skypename = stmt.get_column_string (106);
            obj.stack_version = stmt.get_column_int64 (107);
            obj.timezone = get_timezone (stmt.get_column_int64 (108));
            obj.type = stmt.get_column_int64 (109);
            obj.unified_servants = stmt.get_column_string (110);
            obj.verified_company = stmt.get_column_bytearray (111);
            obj.verified_email = stmt.get_column_bytearray (112);

            // Add contacts to the list
            contacts_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load File Transfers
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_file_transfers (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Transfers table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Transfers
        auto stmt = db.new_statement (
            "SELECT accepttime,"
            "bytespersecond,"
            "bytestransferred,"
            "chatmsg_guid,"
            "chatmsg_index,"
            "convo_id,"
            "extprop_handled_by_chat,"
            "extprop_hide_from_history,"
            "extprop_localfilename,"
            "extprop_window_visible,"
            "failurereason,"
            "filename,"
            "filepath,"
            "filesize,"
            "finishtime,"
            "flags,"
            "id,"
            "is_permanent,"
            "last_activity,"
            "nodeid,"
            "offer_send_list,"
            "old_filepath,"
            "old_status,"
            "parent_id,"
            "partner_dispname,"
            "partner_handle,"
            "pk_id,"
            "starttime,"
            "status,"
            "type "
            "FROM Transfers",
            schema_version_
        );

        // Retrieve records from Transfers table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            file_transfer obj;

            obj.idx = idx++;
            obj.accepttime = get_datetime (stmt.get_column_int64 (0));
            obj.bytespersecond = stmt.get_column_int64 (1);
            obj.bytestransferred = stmt.get_column_string (2);
            obj.chatmsg_guid = stmt.get_column_bytearray (3).to_guid ();
            obj.chatmsg_index = stmt.get_column_int64 (4);
            obj.convo_id = stmt.get_column_int64 (5);
            obj.extprop_handled_by_chat = stmt.get_column_int64 (6);
            obj.extprop_hide_from_history = stmt.get_column_int64 (7);
            obj.extprop_localfilename = stmt.get_column_string (8);
            obj.extprop_window_visible = stmt.get_column_int64 (9);
            obj.failurereason = stmt.get_column_int64 (10);
            obj.filename = stmt.get_column_string (11);
            obj.filepath = stmt.get_column_string (12);
            obj.filesize = stmt.get_column_string (13);
            obj.finishtime = get_datetime (stmt.get_column_int64 (14));
            obj.flags = stmt.get_column_int64 (15);
            obj.id = stmt.get_column_int64 (16);
            obj.is_permanent = stmt.get_column_bool (17);
            obj.last_activity = stmt.get_column_int64 (18);
            obj.nodeid = stmt.get_column_bytearray (19);
            obj.offer_send_list = stmt.get_column_string (20);
            obj.old_filepath = stmt.get_column_int64 (21);
            obj.old_status = stmt.get_column_int64 (22);
            obj.parent_id = stmt.get_column_int64 (23);
            obj.partner_dispname = stmt.get_column_string (24);
            obj.partner_handle = stmt.get_column_string (25);
            obj.pk_id = stmt.get_column_int64 (26);
            obj.starttime = get_datetime (stmt.get_column_int64 (27));
            obj.status = stmt.get_column_int64 (28);
            obj.type = stmt.get_column_int64 (29);

            // Add transfers to the list
            file_transfers_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
// @brief Load Voicemails
// @param db Database object
// =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
void
file_main_db::_load_voicemails (mobius::core::database::database &db)
{
    mobius::core::log log (__FILE__, __FUNCTION__);

    // Voicemails table was dropped between schema version 259 and 308
    if (schema_version_ > 307)
        return;

    try
    {
        // Prepare SQL statement for table Voicemails
        auto stmt = db.new_statement (
            "SELECT allowed_duration,"
            "chatmsg_guid,"
            "convo_id,"
            "duration,"
            "extprop_hide_from_history,"
            "failurereason,"
            "failures,"
            "flags,"
            "id,"
            "is_permanent,"
            "notification_id,"
            "partner_dispname,"
            "partner_handle,"
            "path,"
            "playback_progress,"
            "size,"
            "status,"
            "subject,"
            "timestamp,"
            "type,"
            "vflags,"
            "xmsg "
            "FROM Voicemails"
        );

        // Retrieve records from Voicemails table
        std::uint64_t idx = 0;

        while (stmt.fetch_row ())
        {
            voicemail obj;

            obj.idx = idx++;
            obj.allowed_duration = stmt.get_column_int64 (0);
            obj.chatmsg_guid = stmt.get_column_bytearray (1).to_guid ();
            obj.convo_id = stmt.get_column_int64 (2);
            obj.duration = stmt.get_column_int64 (3);
            obj.extprop_hide_from_history = stmt.get_column_int64 (4);
            obj.failurereason = stmt.get_column_int64 (5);
            obj.failures = stmt.get_column_int64 (6);
            obj.flags = stmt.get_column_int64 (7);
            obj.id = stmt.get_column_int64 (8);
            obj.is_permanent = stmt.get_column_bool (9);
            obj.notification_id = stmt.get_column_int64 (10);
            obj.partner_dispname = stmt.get_column_string (11);
            obj.partner_handle = stmt.get_column_string (12);
            obj.path = stmt.get_column_string (13);
            obj.playback_progress = stmt.get_column_int64 (14);
            obj.size = stmt.get_column_int64 (15);
            obj.status = stmt.get_column_int64 (16);
            obj.subject = stmt.get_column_string (17);
            obj.timestamp = get_datetime (stmt.get_column_int64 (18));
            obj.type = stmt.get_column_int64 (19);
            obj.vflags = stmt.get_column_int64 (20);
            obj.xmsg = stmt.get_column_string (21);

            // Add voicemails to the list
            voicemails_.emplace_back (std::move (obj));
        }
    }
    catch (const std::exception &e)
    {
        log.warning (__LINE__, e.what ());
    }
}

} // namespace mobius::extension::app::skype
